# üß™ –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ9 ‚Äî Pytest + SQLAlchemy

## üìå –û–ø–∏—Å–∞–Ω–∏–µ
–í —Ä–∞–º–∫–∞—Ö –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Å—É—â–Ω–æ—Å—Ç—å—é **Student**  
—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **pytest**, **SQLAlchemy** –∏ **PostgreSQL**.

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- —Ä–∞–±–æ—Ç—É —Å –ë–î —á–µ—Ä–µ–∑ ORM
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pytest-—Ñ–∏–∫—Å—Ç—É—Ä
- –Ω–∞–ø–∏—Å–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è CRUD-–ª–æ–≥–∏–∫–∏
- –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é flake8

---

## üñ•Ô∏è –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ä–µ–¥–∞
- **OS:** Windows  
- **Python:** 3.14 (virtualenv)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL
- **ORM:** SQLAlchemy
- **–¢–µ—Å—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫:** pytest
- **–õ–∏–Ω—Ç–µ—Ä:** flake8

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–¥–∞–Ω–∏—è
09_lesson/
‚îú‚îÄ‚îÄ db/
‚îÇ ‚îú‚îÄ‚îÄ models.py
‚îÇ ‚îî‚îÄ‚îÄ conftest.py
‚îú‚îÄ‚îÄ test_students.py

---

## üß† –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ
1. –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `DATABASE_URL`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å `Student` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º—è–≥–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è (`soft delete`)
3. –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã pytest-—Ñ–∏–∫—Å—Ç—É—Ä—ã:
   - —Å–æ–∑–¥–∞–Ω–∏–µ engine
   - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü
   - –≤—ã–¥–∞—á–∞ `db_session` –≤ —Ç–µ—Å—Ç—ã
4. –ù–∞–ø–∏—Å–∞–Ω—ã –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### `test_create_student`
- —Å–æ–∑–¥–∞—ë—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∑–∞–ø–∏—Å—å –ø–æ—è–≤–∏–ª–∞—Å—å –≤ –ë–î
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ `deleted_at = None`

### `test_update_student_email`
- —Å–æ–∑–¥–∞—ë—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞
- –æ–±–Ω–æ–≤–ª—è–µ—Ç email
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã

### `test_soft_delete_student`
- —Å–æ–∑–¥–∞—ë—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞
- –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø–æ–ª–µ `deleted_at` –∑–∞–ø–æ–ª–Ω–µ–Ω–æ

---

## ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã
pip install pytest sqlalchemy psycopg2-binary flake8
–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ø—Ä–∏–º–µ—Ä)
$env:DATABASE_URL="postgresql+psycopg2://postgres:password@localhost:5432/qa_tests"
–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pytest 09_lesson -q

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –ª–∏–Ω—Ç–µ—Ä–æ–º
flake8 09_lesson

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

–í—Å–µ —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ö–æ–¥—è—Ç ‚úÖ

flake8 –Ω–µ –≤—ã–¥–∞—ë—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ ‚úÖ

–ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
## üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
–î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `DATABASE_URL`.

–ü—Ä–∏–º–µ—Ä:
postgresql://user:password@localhost:5432/database_name
